# cre_stable_coin
# Local Currency Stablecoin Platform

> **Create USDT-backed stablecoins for any local currency with real-time oracle price feeds**

A production-ready, decentralized stablecoin system that enables anyone to create local currency tokens (ILS, EGP, TRY, etc.) backed 100% by USDT with automatic price updates from Chainlink's Compute Runtime Environment (CRE).


---

## ğŸ¯ The Idea

### The Problem: Financial Exclusion & Economic Instability

Millions of people worldwide face critical financial challenges:

**ğŸŒ In Local Markets**:
- **Banking Barriers**: No access to traditional banking or international transfers
- **Remittance Costs**: 7-15% fees on international money transfers
- **Capital Controls**: Governments restricting access to foreign currency
- **No Digital Infrastructure**: Lack of digital payment systems

**ğŸ’” Real Impact**:
- Workers abroad can't send money home efficiently
- People are locked out of the global digital economy
- No permissionless way to receive and store funds

### The Solution: Digital Transformation for Survival

**Enable anyone, anywhere to:**

1. **ğŸ¦ Store Money Safely**
   - Convert local currency â†’ USDT â†’ Local stablecoin
   - Accessible 24/7, no bank required

2. **ğŸŒ Participate in Digital Economy**
   - Accept payments in stable local currency
   - Access global DeFi without crypto volatility
   - Permissionless - no bank account or credit check needed

3. **ğŸ¤ Receive Funds to Survive**
   - Family abroad sends USDT â†’ automatically converts to local stablecoin
   - No intermediaries, no rejection, no delays
   - Transparent, predictable exchange rates
   - Near-zero fees compared to traditional remittances

4. **ğŸ“± Drive Digital Transformation**
   - Smartphone + wallet = full financial access
   - Build local payment systems on stable foundation
   - Create local DeFi ecosystems
   - Financial inclusion for the unbanked

### How It Empowers Users

**For Individuals**:
- âœ… Receive remittances at fair exchange rates
- âœ… No bank account or documents required
- âœ… Full custody - you own your money

**For Businesses**:
- âœ… Accept digital payments in local currency
- âœ… No exchange rate risk on holdings
- âœ… Instant settlement, no chargebacks
- âœ… Access to global liquidity

**For Communities**:
- âœ… Build local circular economies
- âœ… Create savings pools
- âœ… Financial services for the underserved
- âœ… Economic resilience and self-sovereignty

### Technical Solution

This platform provides:
- âœ… **Local Currency Stablecoins**: Create tokens pegged to any fiat currency (ILS, EGP, TRY, etc.)
- âœ… **100% USDT Backed**: Every token is fully collateralized by USDT
- âœ… **Real-Time Oracle Pricing**: Chainlink CRE provides decentralized, accurate exchange rates
- âœ… **Multi-Network**: Deploy on 15+ EVM chains (Ethereum, Polygon, Arbitrum, BSC, etc.)
- âœ… **Permissionless**: No KYC, no accounts, no gatekeepers
- âœ… **Fully Decentralized**: No centralized points of failure

### How It Works

```
User deposits USDT
         â†“
Smart Contract checks oracle for exchange rate
         â†“
Mints local currency tokens (e.g., 1000 USDT â†’ 3,223 ILS tokens)
         â†“
User can redeem anytime to get USDT back
```

### Real-World Example: Palestinian Shekel Digital (PLSd)

**Scenario**: Mahmoud works in Dubai and sends money to his family in Palestine

**Traditional Way** (Expensive & Slow):
1. Mahmoud goes to Western Union
2. Pays $100 + $15 fee (15%)
3. Family waits 2-3 days
4. Receives â‚ª365 (after poor exchange rate)
5. Banks may block or delay transfer

**With PLSd** (Fast & Fair):
1. Mahmoud buys 100 USDT on any exchange
2. Sends to family's wallet (2 minutes, $0.10 fee)
3. Family converts 100 USDT â†’ 3,223 PLSd instantly
4. Oracle ensures fair exchange rate: 1 USDT = 3.223 ILS
5. Family can:
   - Hold PLSd (protected from inflation)
   - Use PLSd in local DeFi
   - Redeem to USDT anytime
   - Convert back to cash via local exchanges

**Impact**:
- âœ… Saved $14.90 in fees (99% cheaper)
- âœ… Received in 2 minutes instead of 2-3 days
- âœ… Transparent, fair exchange rate
- âœ… No bank or intermediary required
- âœ… Permissionless - cannot be blocked

---

## ğŸŒ Use Cases & Real-World Impact

### 1. Remittances - Sending Money Home

**Problem**: $700+ billion sent home annually, with $50+ billion lost to fees

**Solution**:
```
Worker Abroad                        Family at Home
     â”‚                                      â”‚
     â”œâ”€ Buys USDT ($100)                   â”‚
     â”‚                                      â”‚
     â”œâ”€ Sends to family wallet             â”‚
     â”‚  (Cost: $0.10, Time: 2 min)         â”‚
     â”‚                                      â”‚
     â”‚                              Family receives
     â”‚                              100 USDT instantly
     â”‚                                      â”‚
     â”‚                              Converts to PLSd
     â”‚                              (3,223 PLSd = ~$100)
     â”‚                                      â”‚
     â”‚                              Uses for daily expenses
     â”‚                              in local economy
```

**Impact**:
- Save 99% on fees ($15 â†’ $0.10)
- Instant instead of 2-3 days
- Can't be blocked by banks
- Fair exchange rates


### 2. Digital Payments for Local Businesses

**Problem**: Can't accept digital payments, lose customers

**Solution**:
```
Local Merchant                      Customer
     â”‚                                 â”‚
     â”œâ”€ Posts QR code                  â”‚
     â”‚  (wallet address)               â”‚
     â”‚                                 â”‚
     â”‚                          Customer scans
     â”‚                          & sends PLSd
     â”‚                                 â”‚
     â”œâ”€ Receives payment instantly     â”‚
     â”‚  No chargebacks                 â”‚
     â”‚  No 3% credit card fees         â”‚
     â”‚                                 â”‚
     â””â”€ Can hold PLSd or convert
        to USDT for stability
```

**Impact**:
- Merchants save 3-5% on payment fees
- Instant settlement
- Access to digital economy
- Builds local payment infrastructure

### 3. Cross-Border Trade & Commerce

**Problem**: Businesses can't trade internationally due to currency controls

**Solution**:
```
Palestinian Exporter        International Buyer
         â”‚                          â”‚
         â”‚                   Pays in USDT
         â”‚                          â”‚
         â”œâ”€ Receives payment        â”‚
         â”‚  (no bank delays)        â”‚
         â”‚                          â”‚
         â”œâ”€ Converts to PLSd        â”‚
         â”‚  (holds stable value)    â”‚
         â”‚                          â”‚
         â””â”€ Uses for local expenses
            or international purchases
```

**Impact**:
- Enable international trade
- Bypass banking restrictions
- Transparent pricing
- Build export economies

### 4. Community Lending & DeFi

**Problem**: No access to banking services or credit

**Solution**:
```
Local Community Pool
     â”‚
     â”œâ”€ Members deposit PLSd
     â”‚  (community savings)
     â”‚
     â”œâ”€ Smart contract manages pool
     â”‚  (transparent, automated)
     â”‚
     â”œâ”€ Members can borrow PLSd
     â”‚  (terms set by community)
     â”‚
     â””â”€ Interest stays in community
        (vs banks extracting value)
```

**Impact**:
- Community-owned financial services
- Transparent lending terms
- Financial inclusion for unbanked
- Build local wealth

### 5. NGO & Humanitarian Aid

**Problem**: Aid money lost to middlemen and corruption

**Solution**:
```
International NGO           Beneficiary Family
     â”‚                           â”‚
     â”œâ”€ Sends USDT               â”‚
     â”‚  (transparent on-chain)   â”‚
     â”‚                           â”‚
     â”‚                   Receives & converts
     â”‚                   to local stablecoin
     â”‚                           â”‚
     â”‚                   Full transparency
     â”‚                   No middlemen
     â”‚                   Direct assistance
```

**Impact**:
- 100% of aid reaches recipients
- Transparent distribution
- Instant delivery
- Empowers recipients with choice

---


## ğŸ—ï¸ Architecture

The system consists of two main components:

### 1. Chainlink CRE Workflow (`stable_coin/`)
**Purpose**: Fetch real-time exchange rates from multiple sources and deliver to blockchain

**Technology Stack**:
- TypeScript
- Chainlink CRE SDK
- External APIs (ExchangeRate-API, Coingecko, etc.)

**Process**:
1. Fetches USDT/USD rate from Coingecko API
2. Fetches USD/LocalCurrency rate from ExchangeRate-API
3. Aggregates results using median consensus
4. Delivers to on-chain PriceFeedReceiver contract
5. Runs every minute via cron trigger

### 2. Smart Contracts (`smart_contract/`)
**Purpose**: Manage stablecoin issuance, redemption, and collateral

**Technology Stack**:
- Solidity 0.8.20
- Foundry (testing & deployment)
- OpenZeppelin contracts

**Components**:
- **LocalCurrencyToken**: Main ERC20 stablecoin contract
- **PriceFeedReceiver**: Receives oracle updates from Chainlink CRE
- **USDTAddressProvider**: Multi-network USDT address resolver
- **MockUSDT**: Testing token for networks without USDT

---

## ğŸ“Š System Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”
â”‚                    Chainlink CRE Workflow                    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚  Coingecko    â”‚    â”‚ ExchangeRate â”‚                       â”‚
â”‚  â”‚  API         â”‚    â”‚ API          â”‚                        â”‚
â”‚  â”‚ (USDT/USD)   â”‚    â”‚ (USD/ILS)    â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚         â”‚                   â”‚                                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼                                â”‚
â”‚                             â†“                                â”‚
â”‚                     Consensus Aggregation                    â”‚
â”‚                      (Median, Validation)                    â”‚
â”‚                             â†“                                â”‚
â”‚                    USDT/ILS Price Feed                       â”‚
â”‚                             â†“                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    Chainlink Keystone
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Smart Contracts                         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          PriceFeedReceiver (Oracle)                   â”‚  â”‚
â”‚  â”‚  â€¢ Receives price updates from Chainlink CRE          â”‚  â”‚
â”‚  â”‚  â€¢ Validates reports                                  â”‚  â”‚
â”‚  â”‚  â€¢ Stores latest exchange rate                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      LocalCurrencyToken (ERC20 Stablecoin)            â”‚  â”‚
â”‚  â”‚  â€¢ Mints tokens when users deposit USDT               â”‚  â”‚
â”‚  â”‚  â€¢ Burns tokens when users redeem for USDT            â”‚  â”‚
â”‚  â”‚  â€¢ 100% USDT collateralized                           â”‚  â”‚
â”‚  â”‚  â€¢ Configurable fees (mint/redeem)                    â”‚  â”‚
â”‚  â”‚  â€¢ Admin controls & pause mechanism                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              USDT Contract                            â”‚  â”‚
â”‚  â”‚  â€¢ Holds all collateral                               â”‚  â”‚
â”‚  â”‚  â€¢ Automatically detected per network                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Quick Start

### Prerequisites

```bash
# Install Bun (for Chainlink CRE workflow)
curl -fsSL https://bun.sh/install | bash

# Install Foundry (for smart contracts)
curl -L https://foundry.paradigm.xyz | bash
foundryup

# Install Chainlink CRE CLI
npm install -g @chainlink/cre
```

### Clone and Setup

```bash
# Clone repository
git clone <repository-url>
cd stable_coin

# Install workflow dependencies
cd stable_coin
bun install

# Install smart contract dependencies
cd ../smart_contract
forge install
```

---

## ğŸ§ª Testing

### Smart Contract Tests

```bash
cd smart_contract

# Run all tests (104 tests)
forge test

# Run with detailed output
forge test -vv

# Run specific test suite
forge test --match-contract FeeManagementTest -vv

# Run fuzz tests (2,827 randomized runs)
forge test --match-contract FuzzTest

# Run invariant tests (128,000 operations)
forge test --match-contract InvariantTest

# Run fork tests (with real USDT)
forge test --match-contract ForkTest --fork-url https://eth.llamarpc.com -vv

# Gas report
forge test --gas-report
```

**Expected Output**:
```
â•­------------------------+--------+--------+---------â•®
| Test Suite             | Passed | Failed | Skipped |
+====================================================+
| LocalCurrencyTokenTest | 40     | 0      | 0       |
| FeeManagementTest      | 16     | 0      | 0       |
| FuzzTest               | 11     | 0      | 0       |
| InvariantTest          | 11     | 0      | 0       |
| ForkTest               | 11     | 0      | 0       |
| PriceFeedReceiverTest  | 15     | 0      | 0       |
â•°------------------------+--------+--------+---------â•¯

Total: 104 tests passing
```

### Chainlink CRE Workflow Tests

```bash
cd stable_coin

# Simulate workflow locally
cre workflow simulate ./stable_coin -T staging-settings --non-interactive --trigger-index 0

# Expected: Workflow executes and returns USDT/ILS price
```

---

## ğŸ“š Documentation

### ğŸ—ï¸ Smart Contracts
- **[Smart Contract README](smart_contract/README.md)** - Smart contract overview and testing
- **[COMPLETE_SUMMARY.md](smart_contract/docs/COMPLETE_SUMMARY.md)** - Complete system overview
- **[FEE_SYSTEM.md](smart_contract/docs/FEE_SYSTEM.md)** - Fee management system
- **[FUZZ_TESTING.md](smart_contract/docs/FUZZ_TESTING.md)** - Comprehensive fuzz testing (2,827 runs)
- **[FORK_TESTING.md](smart_contract/docs/FORK_TESTING.md)** - Fork testing with real USDT contracts

### ğŸ”® Oracle & Workflow

- **[USDT_ILS_WORKFLOW.md](USDT_ILS_WORKFLOW.md)** - Detailed workflow implementation

---

## âš™ï¸ Production Configuration Notes

### Important Configuration Details:

1. **Oracle Update Schedule**:
   - **Testing**: `"0 */1 * * * *"` (every 1 minute)
   - **Production**: `"0 */15 * * * *"` (every 15 minutes recommended)

2. **API Key Management**:
   - `API_KEY` is fetched from `secrets.yaml` file
   - `.env` file should have `API_KEY_ALL` set

3. **Network Support**:
   - `chainSelectorName` is set to `sepolia` for testing
   - Can support **any network supported by Chainlink CRE**:
     - Ethereum Mainnet, Sepolia
     - Polygon, Mumbai
     - Arbitrum, Arbitrum Sepolia
     - Optimism, Optimism Sepolia
     - Base, Base Sepolia
     - Avalanche, Fuji
     - And more...

## ğŸ”§ Running the System

### 1. Local Development (Testing)

#### Start Local Blockchain
```bash
# Terminal 1: Run Anvil (local Ethereum node)
anvil
```

#### Deploy Smart Contracts
```bash
# Terminal 2: Deploy to local network
cd smart_contract
forge script script/DeployTest.s.sol --rpc-url http://localhost:8545 --broadcast -vvv
```

**What This Does**:
- Deploys MockUSDT (test USDT)
- Deploys PriceFeedReceiver (oracle)
- Deploys LocalCurrencyToken (stablecoin)
- Tests mint and redeem functions

#### Test the Workflow
```bash
# Terminal 3: Run Chainlink CRE workflow
cd stable_coin
cre workflow simulate ./stable_coin -T staging-settings --non-interactive --trigger-index 0
```

### 2. Testnet Deployment

#### Configure Environment
```bash
cd smart_contract

# Create .env file
cat > .env << 'EOF'
PRIVATE_KEY=0x...                    # Your deployer private key
ALCHEMY_API_KEY=0x...                  # Admin address for governance
EOF
```

#### Deploy to Sepolia
```bash
source .env

forge script script/Deploy.s.sol --rpc-url "https://eth-sepolia.g.alchemy.com/v2/$ALCHEMY_API_KEY"  --broadcast -vvv
```

## ğŸŒ Frontend Integration

### Install Dependencies

```bash
npm install ethers@^6
# or
npm install viem wagmi
```

### Contract ABIs

Located in:
- `smart_contract/out/StableCoin.sol/LocalCurrencyToken.json`
- `smart_contract/out/PriceFeedReceiver.sol/PriceFeedReceiver.json`

### Example: React + ethers.js

```typescript
import { ethers } from 'ethers';
import StableCoinABI from './abis/LocalCurrencyToken.json';
import USDTABI from './abis/IERC20.json';

// Contract addresses (from deployment)
const STABLECOIN_ADDRESS = '0x...';
const USDT_ADDRESS = '0xdAC17F958D2ee523a2206206994597C13D831ec7'; // Ethereum

// Connect to wallet
const provider = new ethers.BrowserProvider(window.ethereum);
const signer = await provider.getSigner();

// Initialize contracts
const stableCoin = new ethers.Contract(STABLECOIN_ADDRESS, StableCoinABI.abi, signer);
const usdt = new ethers.Contract(USDT_ADDRESS, USDTABI, signer);

// Mint stablecoins
async function mintTokens(usdtAmount: bigint) {
  // 1. Approve USDT
  const approveTx = await usdt.approve(STABLECOIN_ADDRESS, usdtAmount);
  await approveTx.wait();

  // 2. Mint tokens
  const mintTx = await stableCoin.mint(usdtAmount);
  const receipt = await mintTx.wait();

  // 3. Get minted amount from events
  const mintEvent = receipt.logs.find(
    log => log.topics[0] === ethers.id('Minted(address,uint256,uint256,uint256)')
  );

  return mintEvent;
}

// Redeem USDT
async function redeemTokens(tokenAmount: bigint) {
  const tx = await stableCoin.redeem(tokenAmount);
  const receipt = await tx.wait();
  return receipt;
}

// Get exchange rate
async function getExchangeRate() {
  const rate = await stableCoin.getExchangeRate();
  return rate;
}

// Preview mint amount
async function previewMint(usdtAmount: bigint) {
  const tokens = await stableCoin.previewDeposit(usdtAmount);
  return tokens;
}

// Preview redeem amount
async function previewRedeem(tokenAmount: bigint) {
  const usdt = await stableCoin.previewRedeem(tokenAmount);
  return usdt;
}

// Get user balance
async function getBalance(address: string) {
  const balance = await stableCoin.balanceOf(address);
  return balance;
}

// Get contract info
async function getInfo() {
  const info = await stableCoin.getInfo();
  return {
    exchangeRate: info[0],
    totalSupply: info[1],
    totalCollateral: info[2],
    netCollateral: info[3],
    collateralRatio: info[4],
    minDeposit: info[5],
    minWithdrawal: info[6],
    useOracle: info[7],
    paused: info[8],
    feesCollected: info[9],
    mintFeeBps: info[10],
    redeemFeeBps: info[11],
  };
}
```

### Example: React Component

```tsx
import { useState, useEffect } from 'react';
import { ethers } from 'ethers';

function StableCoinApp() {
  const [balance, setBalance] = useState('0');
  const [usdtAmount, setUsdtAmount] = useState('');
  const [tokenAmount, setTokenAmount] = useState('');
  const [exchangeRate, setExchangeRate] = useState('0');

  useEffect(() => {
    loadData();
  }, []);

  async function loadData() {
    const rate = await getExchangeRate();
    setExchangeRate(ethers.formatUnits(rate, 6)); // 6 decimals

    const signer = await provider.getSigner();
    const addr = await signer.getAddress();
    const bal = await getBalance(addr);
    setBalance(ethers.formatEther(bal)); // 18 decimals
  }

  async function handleMint() {
    const amount = ethers.parseUnits(usdtAmount, 6); // USDT has 6 decimals
    await mintTokens(amount);
    await loadData();
  }

  async function handleRedeem() {
    const amount = ethers.parseEther(tokenAmount); // Tokens have 18 decimals
    await redeemTokens(amount);
    await loadData();
  }

  return (
    <div>
      <h1>Local Currency Stablecoin</h1>

      <div>
        <h2>Your Balance: {balance} PLSd</h2>
        <p>Exchange Rate: 1 USDT = {exchangeRate} ILS</p>
      </div>

      <div>
        <h3>Mint Tokens</h3>
        <input
          type="number"
          value={usdtAmount}
          onChange={e => setUsdtAmount(e.target.value)}
          placeholder="USDT Amount"
        />
        <button onClick={handleMint}>Mint PLSd</button>
      </div>

      <div>
        <h3>Redeem USDT</h3>
        <input
          type="number"
          value={tokenAmount}
          onChange={e => setTokenAmount(e.target.value)}
          placeholder="PLSd Amount"
        />
        <button onClick={handleRedeem}>Redeem for USDT</button>
      </div>
    </div>
  );
}
```

### Example: wagmi/viem (Recommended)

```typescript
import { useContractRead, useContractWrite, usePrepareContractWrite } from 'wagmi';

// Read exchange rate
const { data: exchangeRate } = useContractRead({
  address: STABLECOIN_ADDRESS,
  abi: StableCoinABI.abi,
  functionName: 'getExchangeRate',
});

// Prepare mint transaction
const { config } = usePrepareContractWrite({
  address: STABLECOIN_ADDRESS,
  abi: StableCoinABI.abi,
  functionName: 'mint',
  args: [BigInt(usdtAmount)],
});

// Execute mint
const { write: mint } = useContractWrite(config);
```

### API Endpoints for Frontend

You can expose these read-only endpoints:

```typescript
// Express.js example
import express from 'express';
import { ethers } from 'ethers';

const app = express();
const provider = new ethers.JsonRpcProvider(RPC_URL);
const stableCoin = new ethers.Contract(ADDRESS, ABI, provider);

app.get('/api/rate', async (req, res) => {
  const rate = await stableCoin.getExchangeRate();
  res.json({ rate: rate.toString() });
});

app.get('/api/info', async (req, res) => {
  const info = await stableCoin.getInfo();
  res.json({
    exchangeRate: info[0].toString(),
    totalSupply: info[1].toString(),
    totalCollateral: info[2].toString(),
    // ... etc
  });
});

app.get('/api/balance/:address', async (req, res) => {
  const balance = await stableCoin.balanceOf(req.params.address);
  res.json({ balance: balance.toString() });
});

app.listen(3000);
```

---

## ğŸ“¦ Project Structure

```
|
|   stable_coin/
|   â”œâ”€â”€ stable_coin/                 # Chainlink CRE Workflow
|   â”‚   â”œâ”€â”€ main.ts                  # Workflow logic
|   â”‚   â”œâ”€â”€ workflow.yaml            # Workflow configuration
|   â”‚   â”œâ”€â”€ config.staging.json      # Staging settings
|   â”‚   â”œâ”€â”€ config.production.json   # Production settings
|   â”‚   â”œâ”€â”€ package.json
|   â”‚
|   â”œâ”€â”€ smart_contract/              # Solidity Smart Contracts
|   â”‚   â”œâ”€â”€ docs/
|   â”‚   â”‚   â””â”€â”€ COMPLETE_SUMMARY.md
|   â”‚   â”‚   â””â”€â”€ FEE_SYSTEM.md
|   â”‚   â”‚   â””â”€â”€ FUZZ_TESTING.md
|   â”‚   â”‚   â””â”€â”€ FORK_TESTING.md
|   â”‚   â”‚
|   â”‚   â”œâ”€â”€ src/
|   â”‚   â”‚   â”œâ”€â”€ StableCoin.sol       # Main stablecoin contract
|   â”‚   â”‚   â”œâ”€â”€ PriceFeedReceiver.sol # Oracle receiver
|   â”‚   â”‚   â”œâ”€â”€ MockUSDT.sol         # Test USDT
|   â”‚   â”‚   â””â”€â”€ keystone/            # Chainlink interfaces
|   â”‚   â”‚
|   â”‚   â”œâ”€â”€ script/
|   â”‚   â”‚   â”œâ”€â”€ Deploy.s.sol         # Deployment script
|   â”‚   â”‚   â”œâ”€â”€ DeployTest.s.sol     # Test deployment
|   â”‚   â”‚   â””â”€â”€ USDTAddressProvider.sol # Multi-network USDT
|   â”‚   â”‚
|   â”‚   â”œâ”€â”€ test/
|   â”‚   â”‚   â”œâ”€â”€ StableCoin.t.sol     # Unit tests (40)
|   â”‚   â”‚   â”œâ”€â”€ FeeManagement.t.sol  # Fee tests (16)
|   â”‚   â”‚   â”œâ”€â”€ Fuzz.t.sol           # Fuzz tests (11)
|   â”‚   â”‚   â”œâ”€â”€ Invariant.t.sol      # Invariant tests (11)
|   â”‚   â”‚   â”œâ”€â”€ Fork.t.sol           # Fork tests (11)
|   â”‚   â”‚   â””â”€â”€ PriceFeedReceiver.t.sol # Oracle tests (15)
|   â”‚   â”‚
|   â”‚   â”œâ”€â”€ foundry.toml
|   â”‚   â””â”€â”€ README.md
|   â”‚
|   â”‚
|
|   â”œâ”€â”€ project.yml
|   â”œâ”€â”€ secret.yml
|   â”œâ”€â”€ README.md
â””â”€â”€ README.md                    # This file
```

## ğŸ“„ License

MIT License - see LICENSE file

---

**Built with â¤ï¸ for financial inclusion and decentralized finance**


